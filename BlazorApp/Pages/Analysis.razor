@page "/Analysis"
@using System.Net.Http
@using System.Net.Http.Json
@using System.Threading.Tasks
@inject HttpClient Http

<PageTitle>Analysis</PageTitle>

<h1>Analysis</h1>

@foreach (var author in authors) {
            <p>Author: @author.author</p>
            @foreach (var freq in @author.frequencies) {
                <p>@freq.frequency  @freq.date</p>
            }
        }
@foreach (var freq in @frequencies) {
                <p>@freq.frequency  @freq.date</p>
            }
        

<button class="btn btn-primary" @onclick="getAuthorAnalysis">Author Analysis</button>
<button class="btn btn-primary" @onclick="getFrequencyAnalysis">Frequency Analysis</button>


@code {
    private AuthorDTO[] authors = new AuthorDTO[] {};
    private FrequencyDTO[] frequencies = new FrequencyDTO[] {};

    protected async Task getAuthorAnalysis()
    {
        frequencies = new FrequencyDTO[] {};
        authors = await Http.GetFromJsonAsync<AuthorDTO[]>("https://localhost:7024/analysis/Mlth/BDSAProject/author");
    }

    protected async Task getFrequencyAnalysis() 
    {
        authors = new AuthorDTO[] {};
        frequencies = await Http.GetFromJsonAsync<FrequencyDTO[]>("https://localhost:7024/analysis/Mlth/BDSAProject/frequency");
    }

    public class AuthorDTO {
        public string author {get; set;}
        public IEnumerable<FrequencyDTO> frequencies {get; set;} = new List<FrequencyDTO>();
    }

    public record FrequencyDTO{
        public int frequency {get; set;}
        public DateTime date {get; set;}
    }
}
